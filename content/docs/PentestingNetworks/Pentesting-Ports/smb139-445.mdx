---
title: Port 139,445/SMB
description: Pentesting-Ports
---

# Table of Contents
- [Enumeration](#enumeration)
  - [OS Fingerprinting](#os-fingerprinting)
  - [Version Detection](#version-detection)
  
- [Pentesting SMB](#pentesting-smb)
  - [Enumerating Shares](#enumerating-shares)
  - [Anonymous Login](#anonymous-login)
  - [User Enumeration](#user-enumeration)
  - [Brute Forcing](#brute-forcing)


## Enumeration

### OS Fingerprinting

```shell
nmap -p 139,445 --script smb-os-discovery <target_ip>
```

### Version Detection

```shell
nmap -p 139,445 --script smb-protocols <target_ip>
```
### With smbmap
```bash
smbmap -H $ip -u " "
smbmap -H 10.10.11.222 -u " "
```

## Pentesting SMB
We can try to login to see the network shares on the domain using a tool called smbmap. Any name can be used for this as far as we can get in anonymously.

```shell
smbmap -H 10.10.189.115 -u anonymous
```

### Enumerating Shares

```shell
smbclient \\\\<IP>\\ -U <username>
smbclient \\\\<IP>\\<SMB-FOLDER> -U <username>
smbmap -H <target_ip> -u <username>
```

### User Enumeration

```shell
enum4linux -a <target_ip>
```

### Brute Forcing

```shell
hydra -t 1 -V -f -l <username> -P /usr/share/wordlists/rockyou.txt smb://<target_ip>
```

